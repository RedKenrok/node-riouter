var Rioter=function(t){"use strict";function e(t,e){void 0===e&&(e={});for(var r=function(t){for(var e=[],n=0;n<t.length;){var r=t[n];if("*"!==r&&"+"!==r&&"?"!==r)if("\\"!==r)if("{"!==r)if("}"!==r)if(":"!==r)if("("!==r)e.push({type:"CHAR",index:n,value:t[n++]});else{var i=1,o="";if("?"===t[u=n+1])throw new TypeError('Pattern cannot start with "?" at '+u);for(;u<t.length;)if("\\"!==t[u]){if(")"===t[u]){if(0==--i){u++;break}}else if("("===t[u]&&(i++,"?"!==t[u+1]))throw new TypeError("Capturing groups are not allowed at "+u);o+=t[u++]}else o+=t[u++]+t[u++];if(i)throw new TypeError("Unbalanced pattern at "+n);if(!o)throw new TypeError("Missing pattern at "+n);e.push({type:"PATTERN",index:n,value:o}),n=u}else{for(var s="",u=n+1;u<t.length;){var a=t.charCodeAt(u);if(!(a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122||95===a))break;s+=t[u++]}if(!s)throw new TypeError("Missing parameter name at "+n);e.push({type:"NAME",index:n,value:s}),n=u}else e.push({type:"CLOSE",index:n,value:t[n++]});else e.push({type:"OPEN",index:n,value:t[n++]});else e.push({type:"ESCAPED_CHAR",index:n++,value:t[n++]});else e.push({type:"MODIFIER",index:n,value:t[n++]})}return e.push({type:"END",index:n,value:""}),e}(t),i=e.prefixes,o=void 0===i?"./":i,s="[^"+n(e.delimiter||"/#?")+"]+?",u=[],a=0,h=0,l="",c=function(t){if(h<r.length&&r[h].type===t)return r[h++].value},d=function(t){var e=c(t);if(void 0!==e)return e;var n=r[h],i=n.type,o=n.index;throw new TypeError("Unexpected "+i+" at "+o+", expected "+t)},p=function(){for(var t,e="";t=c("CHAR")||c("ESCAPED_CHAR");)e+=t;return e};h<r.length;){var f=c("CHAR"),m=c("NAME"),v=c("PATTERN");if(m||v){var g=f||"";-1===o.indexOf(g)&&(l+=g,g=""),l&&(u.push(l),l=""),u.push({name:m||a++,prefix:g,suffix:"",pattern:v||s,modifier:c("MODIFIER")||""})}else{var y=f||c("ESCAPED_CHAR");if(y)l+=y;else if(l&&(u.push(l),l=""),c("OPEN")){g=p();var w=c("NAME")||"",b=c("PATTERN")||"",x=p();d("CLOSE"),u.push({name:w||(b?a++:""),pattern:w&&!b?s:b,prefix:g,suffix:x,modifier:c("MODIFIER")||""})}else d("END")}}return u}function n(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function r(t){return t&&t.sensitive?"":"i"}function i(t,i,o){return function(t,e,i){void 0===i&&(i={});for(var o=i.strict,s=void 0!==o&&o,u=i.start,a=void 0===u||u,h=i.end,l=void 0===h||h,c=i.encode,d=void 0===c?function(t){return t}:c,p="["+n(i.endsWith||"")+"]|$",f="["+n(i.delimiter||"/#?")+"]",m=a?"^":"",v=0,g=t;v<g.length;v++){var y=g[v];if("string"==typeof y)m+=n(d(y));else{var w=n(d(y.prefix)),b=n(d(y.suffix));if(y.pattern)if(e&&e.push(y),w||b)if("+"===y.modifier||"*"===y.modifier){var x="*"===y.modifier?"?":"";m+="(?:"+w+"((?:"+y.pattern+")(?:"+b+w+"(?:"+y.pattern+"))*)"+b+")"+x}else m+="(?:"+w+"("+y.pattern+")"+b+")"+y.modifier;else m+="("+y.pattern+")"+y.modifier;else m+="(?:"+w+b+")"+y.modifier}}if(l)s||(m+=f+"?"),m+=i.endsWith?"(?="+p+")":"$";else{var N=t[t.length-1],E="string"==typeof N?f.indexOf(N[N.length-1])>-1:void 0===N;s||(m+="(?:"+f+"(?="+p+"))?"),E||(m+="(?="+f+"|"+p+")")}return new RegExp(m,r(i))}(e(t,o),i,o)}function o(t,e,n){return t instanceof RegExp?function(t,e){if(!e)return t;for(var n=/\((?:\?<(.*?)>)?(?!\?)/g,r=0,i=n.exec(t.source);i;)e.push({name:i[1]||r++,prefix:"",suffix:"",modifier:"",pattern:""}),i=n.exec(t.source);return t}(t,e):Array.isArray(t)?function(t,e,n){var i=t.map((function(t){return o(t,e,n).source}));return new RegExp("(?:"+i.join("|")+")",r(n))}(t,e,n):i(t,e,n)}class s extends class{constructor(){this._events={}}destroy(){this._events=null}addListener(t,e){return Object.prototype.hasOwnProperty.call(this._events,t)?this._events[t].indexOf(e)<0&&this._events[t].push(e):this._events[t]=[e],!0}removeListener(t,e){if(!Object.prototype.hasOwnProperty.call(this._events,t))return;if(this._events[t].length<=0)return;const n=this._events[t].indexOf(e);n>=0&&this._events[t].splice(n,1)}removeAllListeners(t){Object.prototype.hasOwnProperty.call(this._events,t)&&delete this._events[t]}dispatch(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];Object.prototype.hasOwnProperty.call(this._events,t)&&(this._events[t].length<=0||this._events[t].forEach((t=>{t(...n)})))}}{constructor(t){void 0===t&&(t=null),super(),this._options=Object.assign({basePath:"",updateHistory:!1,pathToRegexp:{}},t),this._pathCurrent=null,this._routes={},this._routeCurrent=null}destroy(){this._options=null,this._pathCurrent=null,this._routeCurrent=null,this._routes=null,super.destroy()}getPath(){return this._pathCurrent}createRoute(t,e){void 0===e&&(e={});const n=o(t,[],e);return this._routes[t]=t=>n.test(t),this.dispatch("created",{route:t,router:this}),t}removeRoute(t){delete this._routes[t]}getRoutes(){return Object.keys(this._routes)}push(t){const e=t.replace(this._options.basePath,""),n=this._pathCurrent!==e;this._pathCurrent=e;for(const t in this._routes){if((0,this._routes[t])(this._pathCurrent)){this._routeCurrent=t;break}}if(n){if(this._options.updateHistory&&"undefined"!=typeof window){const e=t.includes(this._options.basePath)?t:this._options.basePath+t;e!==window.history.location&&window.history.pushState(null,window.document.title,e)}this.dispatch("pushed",{path:this._pathCurrent,route:this._routeCurrent,router:this})}}}var u=4;function a(t,e){t.firstChild&&(e.appendChild(t.firstChild),a(t,e))}function h(t){Array.from(t).forEach(l)}const l=t=>t&&t.parentNode&&t.parentNode.removeChild(t),c=(t,e)=>e&&e.parentNode&&e.parentNode.insertBefore(t,e),d=Symbol.for("pure"),p=Symbol("parent");function f(t,e){return typeof t===e}function m(t){const e=t.ownerSVGElement;return!!e||null===e}function v(t){return!w(t.content)}function g(t){return f(t,"function")}function y(t){return!w(t)&&f(t,"object")}function w(t){return null==t}const b=Symbol("unmount"),x={nodes:[],mount(t,e){return this.update(t,e)},update(t,e){const{placeholder:n,nodes:r,childrenMap:i}=this,o=t===b?null:this.evaluate(t),s=o?Array.from(o):[],{newChildrenMap:u,batches:a,futureNodes:h}=(n.parentNode,function(t,e,n,r){const{condition:i,template:o,childrenMap:s,itemName:u,getKey:a,indexName:h,root:l,isTemplateTag:c}=r,d=new Map,p=[],f=[];return t.forEach(((t,r)=>{const m=function(t,{itemName:e,indexName:n,index:r,item:i}){t[e]=i,n&&(t[n]=r);return t}(Object.create(e),{itemName:u,indexName:h,index:r,item:t}),v=a?a(m):r,g=s.get(v);if(function(t,e){return!!t&&!1===Boolean(t(e))}(i,m))return;const y=g?g.template:o.clone(),w=g?y.el:l.cloneNode(),b=!g,x=c&&b?function(t){const e=t.dom.cloneNode(!0);return{avoidDOMInjection:!0,fragment:e,children:Array.from(e.childNodes)}}(y):{};if(b?p.push((()=>y.mount(w,m,n,x))):p.push((()=>y.update(m,n))),c){const t=x.children||y.children;f.push(...t)}else f.push(w);s.delete(v),d.set(v,{template:y,context:m,index:r})})),{newChildrenMap:d,batches:p,futureNodes:f}}(s,t,e,this));return((t,e,n,r,i)=>{const o=n.length;let s=e.length,u=o,a=0,h=0,d=null;for(;a<s||h<u;)if(s===a){const t=u<o?h?r(n[h-1],-0).nextSibling:r(n[u-h],0):i;for(;h<u;)c(r(n[h++],1),t)}else if(u===h)for(;a<s;)d&&d.has(e[a])||l(r(e[a],-1)),a++;else if(e[a]===n[h])a++,h++;else if(e[s-1]===n[u-1])s--,u--;else if(e[a]===n[u-1]&&n[h]===e[s-1]){const t=r(e[--s],-1).nextSibling;c(r(n[h++],1),r(e[a++],-1).nextSibling),c(r(n[--u],1),t),e[s]=n[u]}else{if(!d){d=new Map;let t=h;for(;t<u;)d.set(n[t],t++)}if(d.has(e[a])){const t=d.get(e[a]);if(h<t&&t<u){let i=a,o=1;for(;++i<s&&i<u&&d.get(e[i])===t+o;)o++;if(o>t-h){const i=r(e[a],0);for(;h<t;)c(r(n[h++],1),i)}else p=r(n[h++],1),(f=r(e[a++],-1))&&f.parentNode&&f.parentNode.replaceChild(p,f)}else a++}else l(r(e[a++],-1))}var p,f})(0,r,h,function(t,e){return(n,r)=>{if(r<0){const n=t.pop();if(n){const{template:t,context:r}=n;t.unmount(r,e,null)}}return n}}(Array.from(i.values()),e),n),a.forEach((t=>t())),this.childrenMap=u,this.nodes=h,this},unmount(t,e){return this.update(b,e),this}};const N={mount(t,e){return this.update(t,e)},update(t,e){const n=!!this.evaluate(t),r=!this.value&&n,i=this.value&&!n,o=()=>{const n=this.node.cloneNode();c(n,this.placeholder),this.template=this.template.clone(),this.template.mount(n,t,e)};switch(!0){case r:o();break;case i:this.unmount(t);break;default:n&&this.template.update(t,e)}return this.value=n,this},unmount(t,e){return this.template.unmount(t,e,!0),this}};const E="removeAttribute",_="setAttribute",C="undefined"==typeof Element?{}:Element.prototype,O=function(t){const e=new Map,n=n=>(e.has(n)||e.set(n,t.call(this,n)))&&e.get(n);return n.cache=e,n}((t=>C.hasOwnProperty(t)));function A(t,{name:e},n,r){if(!e)return r&&function(t,e,n){const r=e?Object.keys(e):[];Object.keys(n).filter((t=>!r.includes(t))).forEach((e=>t.removeAttribute(e)))}(t,n,r),void(n&&function(t,e){Object.entries(e).forEach((([e,n])=>A(t,{name:e},n)))}(t,n));!O(e)&&(function(t){return f(t,"boolean")}(n)||y(n)||g(n))&&(t[e]=n),t[function(t){return w(t)||!1===t||""===t||y(t)||g(t)?E:_}(n)](e,function(t,e){return!0===e?t:e}(e,n))}const M=/^on/,T={handleEvent(t){this[t.type](t)}},P=new WeakMap;function R(t){return w(t)?"":t}const S=(t,e)=>{const n=t.childNodes[e];if(n.nodeType===Node.COMMENT_NODE){const e=document.createTextNode("");return t.replaceChild(e,n),e}return n};var D={0:A,1:function(t,{name:e},n){const r=e.replace(M,""),i=P.get(t)||(t=>{const e=Object.create(T);return P.set(t,e),e})(t),[o,s]=(t=>Array.isArray(t)?t:[t,!1])(n),u=i[r],a=o&&!u;u&&!o&&t.removeEventListener(r,i),a&&t.addEventListener(r,i,s),i[r]=o},2:function(t,e,n){t.data=R(n)},3:function(t,e,n){t.value=R(n)}};const j={mount(t){return this.value=this.evaluate(t),k(this,this.value),this},update(t){const e=this.evaluate(t);return this.value!==e&&(k(this,e),this.value=e),this},unmount(){return 1===this.type&&k(this,null),this}};function k(t,e){return D[t.type](t.node,t,e,t.value)}const H=(t,e)=>t[p]||e,I={attributes:[],getTemplateScope(t,e){return function(t,e,n){if(!t||!t.length)return n;const r=t.map((t=>({...t,value:t.evaluate(e)})));return Object.assign(Object.create(n||null),function(t){return t.reduce(((t,e)=>{const{value:n,type:r}=e;switch(!0){case!e.name&&0===r:return{...t,...n};case 3===r:t.value=e.value;break;default:t[(i=e.name,i.replace(/-(\w)/g,((t,e)=>e.toUpperCase())))]=e.value}var i;return t}),{})}(r))}(this.attributes,t,e)},mount(t,e){const n=!!t.slots&&t.slots.find((({id:t})=>t===this.name)),{parentNode:r}=this.node,i=H(t,e);return this.template=n&&z(n.html,n.bindings).createDOM(r),this.template&&(this.template.mount(this.node,this.getTemplateScope(t,i),i),this.template.children=Array.from(this.node.childNodes),L(this.node)),l(this.node),this},update(t,e){if(this.template){const n=H(t,e);this.template.update(this.getTemplateScope(t,n),n)}return this},unmount(t,e,n){return this.template&&this.template.unmount(this.getTemplateScope(t,e),null,n),this}};function L(t){const e=t&&t.firstChild;e&&(c(e,t),L(t))}function F(t){return t.reduce(((t,{bindings:e})=>t.concat(e)),[])}const B={mount(t){return this.update(t)},update(t,e){const n=this.evaluate(t);return n===this.name?this.tag.update(t):(this.unmount(t,e,!0),this.name=n,this.tag=function(t,e=[],n=[]){return t?t({slots:e,attributes:n}):z(function(t){return t.reduce(((t,e)=>t+e.html),"")}(e),[...F(e),{expressions:n.map((t=>({type:0,...t})))}])}(this.getComponent(n),this.slots,this.attributes),this.tag.mount(this.node,t)),this},unmount(t,e,n){return this.tag&&this.tag.unmount(n),this}};var U={1:function(t,{evaluate:e,template:n}){const r=document.createTextNode("");return c(r,t),l(t),{...N,node:t,evaluate:e,placeholder:r,template:n.createDOM(t)}},2:function(t,{expressions:e}){return{...(n=e.map((e=>function(t,e){return{...j,...e,node:2===e.type?S(t,e.childNodeIndex):t}}(t,e))),r=["mount","update","unmount"],r.reduce(((t,e)=>({...t,[e]:t=>n.map((n=>n[e](t)))&&i})),{}))};var n,r,i},0:function(t,{evaluate:e,condition:n,itemName:r,indexName:i,getKey:o,template:s}){const u=document.createTextNode(""),a=t.cloneNode();return c(u,t),l(t),{...x,childrenMap:new Map,node:t,root:a,condition:n,evaluate:e,isTemplateTag:v(a),template:s.createDOM(t),getKey:o,indexName:i,itemName:r,placeholder:u}},3:function(t,{evaluate:e,getComponent:n,slots:r,attributes:i}){return{...B,node:t,evaluate:e,slots:r,attributes:i,getComponent:n}},4:function(t,{name:e,attributes:n}){return{...I,attributes:n,node:t,name:e}}};function $(t,e){return t.map((t=>2===t.type?{...t,childNodeIndex:t.childNodeIndex+e}:t))}function K(t,e){return m(t)?function(t,e){return e.ownerDocument.importNode((new window.DOMParser).parseFromString(`<svg xmlns="http://www.w3.org/2000/svg">${t}</svg>`,"application/xml").documentElement,!0)}(e,t):function(t,e){const n=v(e)?e:document.createElement("template");return n.innerHTML=t,n.content}(e,t)}function W(t,e){switch(!0){case m(t):a(e,t);break;case v(t):t.parentNode.replaceChild(e,t);break;default:t.appendChild(e)}}const q=Object.freeze({createDOM(t){return this.dom=this.dom||function(t,e){return e&&("string"==typeof e?K(t,e):e)}(t,this.html),this},mount(t,e,n,r={}){if(!t)throw new Error("Please provide DOM node to mount properly your template");this.el&&this.unmount(e);const{fragment:i,children:o,avoidDOMInjection:s}=r,{parentNode:u}=o?o[0]:t,a=v(t),h=a?Math.max(Array.from(u.childNodes).indexOf(t),0):null;return this.isTemplateTag=a,this.createDOM(t),this.dom&&(this.fragment=i||this.dom.cloneNode(!0)),this.el=this.isTemplateTag?u:t,this.children=this.isTemplateTag?o||Array.from(this.fragment.childNodes):null,!s&&this.fragment&&W(t,this.fragment),this.bindings=this.bindingsData.map((t=>function(t,e,n){const{selector:r,type:i,redundantAttribute:o,expressions:s}=e,u=r?t.querySelector(r):t;o&&u.removeAttribute(o);const a=s||[];return(U[i]||U[2])(u,{...e,expressions:n&&!r?$(a,n):a})}(this.el,t,h))),this.bindings.forEach((t=>t.mount(e,n))),this},update(t,e){return this.bindings.forEach((n=>n.update(t,e))),this},unmount(t,e,n){if(this.el){switch(this.bindings.forEach((r=>r.unmount(t,e,n))),!0){case this.el[d]:break;case this.children&&null!==n:h(this.children);break;case!0===n:l(this.el);break;case null!==n:h(this.el.childNodes)}this.el=null}return this},clone(){return{...this,el:null}}});function z(t,e=[]){return{...q,html:t,bindingsData:e}}const G=function(t){return t[d]=!0,t},V=Symbol("riouter");var J={css:null,exports:G((({slots:t,attributes:e,props:n})=>{const r=t=>e&&e.find((e=>e.name===t));return{mount(e,n){if(t&&t.length){if(this.active=!1,this.el=this.root=e,this.state={},this.slot=z(null,[{type:u,name:"default"}]),this.router=n[V].router,this.path=this.root.getAttribute("path"),!this.path)throw new Error("No path found for route component.");this.route=this.router.createRoute(this.path),this.handleRouteChange=({route:t})=>{const e=this.route===t;this.active!==e&&(this.active=e,this.update(n))},this.router.addListener("pushed",this.handleRouteChange)}},update(e){if(this.active){const n=r("onBeforeMount");n&&n.evaluate(e)(this,this.route,this.router.getPath());const i=document.createElement("div");this.root.appendChild(i),this.slot.mount(i,{slots:t},e);const o=r("onMounted");o&&o.evaluate(e)(this,this.route,this.router.getPath())}else{const n=r("onBeforeUnmount");n&&n.evaluate(e)(this,this.route,this.router.getPath()),this.slot.unmount({slots:t},e,!0);const i=r("onUnmounted");i&&i.evaluate(e)(this,this.route,this.router.getPath())}},unmount(...t){this.router.removeListener("pushed",this.handleRouteChange),this.router.removeRoute(this.path),this.slot.unmount(...t)}}})),template:null,name:"riouter-route"};const Q=window.requestAnimationFrame||window.setTimeout,X=window.cancelAnimationFrame||window.clearTimeout;var Y={css:null,exports:G((({slots:t,attributes:e,props:n})=>{const r=t=>e&&e.find((e=>e.name===t)),i=t=>{const e=r("base");return e?e.evaluate(t):window.location.protocol+"//"+window.location.host};return{mount(e,n){if(!t||!t.length)return;this.el=this.root=e,this.state={};let o=r("updateHistory");o=!!o&&!!o.evaluate(n),this.router=new s({basePath:i(),updateHistory:o}),this.router.push(window.location.href),this.slot=z(null,[{type:u,name:"default"}]),n[V]=this;const a=r("onBeforeStart");a&&a.evaluate(n)(this,this.router,this.router.getPath()),this.slot.mount(this.root,{slots:t},n);const h=r("onStart");h&&h.evaluate(n)(this,this.router,this.router.getPath())},unmount(...t){this.slot&&this.slot.unmount(...t),this.root.remove(),this.router.destroy()},update(t){this.slot&&(this.deferred&&X(this.deferred),this.deferred=Q((()=>{this.slot.update({},this)})))}}})),template:null,name:"riouter-router"};return t.Router=s,t.route=J,t.router=Y,Object.defineProperty(t,"__esModule",{value:!0}),t}({});
